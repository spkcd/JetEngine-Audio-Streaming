/* JetEngine Audio Streaming Admin JS */
(function($){"use strict";$(document).ready(function(){const audioSettings={init:function(){this.initTabs();this.initChartData();this.setupEventListeners()},initTabs:function(){const $tabs=$(".je-audio-tabs");const $tabLinks=$tabs.find(".je-audio-tab-link");const $tabContents=$(".je-audio-tab-content");$tabLinks.on("click",function(e){e.preventDefault();const targetId=$(this).data("tab");$tabLinks.removeClass("active");$(this).addClass("active");$tabContents.hide();$("#"+targetId).show()});$tabLinks.first().trigger("click")},initChartData:function(){const chartCanvas=document.getElementById("networkStatsChart");if(!chartCanvas){return}const ctx=chartCanvas.getContext("2d");if(typeof jeAudioStats==="undefined"){return}const labels=jeAudioStats.dates||[];const data=jeAudioStats.counts||[];const chart=new Chart(ctx,{type:"line",data:{labels:labels,datasets:[{label:"Audio Requests",data:data,borderColor:"#2271b1",backgroundColor:"rgba(34, 113, 177, 0.1)",tension:.4,fill:true}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,ticks:{precision:0}}},plugins:{tooltip:{callbacks:{label:function(context){return context.parsed.y+" requests"}}},legend:{display:false}}}})},setupEventListeners:function(){$("#clear-logs-button").on("click",function(e){e.preventDefault();if(!confirm("Are you sure you want to clear all logs? This cannot be undone.")){return}$.ajax({url:ajaxurl,type:"POST",data:{action:"jet_audio_streaming_clear_logs",nonce:jeAudioAdminVars.nonce},success:function(response){if(response.success){alert("Logs cleared successfully!");window.location.reload()}else{alert("Failed to clear logs: "+response.data.message)}},error:function(){alert("Server error. Please try again.")}})});$("#regenerate-peaks-button").on("click",function(e){e.preventDefault();const attachmentId=$("#attachment-id").val();if(!attachmentId){alert("Please enter a valid attachment ID.");return}$(this).attr("disabled",true).text("Processing...");$.ajax({url:ajaxurl,type:"POST",data:{action:"jet_audio_streaming_regenerate_peaks",attachment_id:attachmentId,nonce:jeAudioAdminVars.nonce},success:function(response){$("#regenerate-peaks-button").attr("disabled",false).text("Regenerate Peaks");if(response.success){alert("Peaks regenerated successfully!")}else{alert("Failed to regenerate peaks: "+response.data.message)}},error:function(){$("#regenerate-peaks-button").attr("disabled",false).text("Regenerate Peaks");alert("Server error. Please try again.")}})})}};audioSettings.init()});})(jQuery); 